{% extends 'navigation.html' %}

{% block content %}

<section class="col_5" style="float:right;">
<table style="margin: 6px;">
	<thead><tr><th>test Group</th><th>Total Score</th><th>Level</th><th>Level Progress</th></tr></thead>
	<tbody>
        {% for group in grouped_marks %}
        <tr><td>{{ group.name }}</td>
        <td>{{ group.total_score }} from {{ group.tests_taken }} test{{ group.tests_taken|pluralize }}</td>
        <td>{{ group.level|floatformat:"0" }}</td>
        <td><progress id='p' max='100' value={{ group.level_progress }}></progress></td>
        </tr>
        {% endfor %}
    </tbody></table>
    <table>
    <thead><tr><th colspan="2">{{ name }}'s Profile</th></tr></thead>
    <tbody>
		<tr><td>Display Name</td><td>{{ name }}</td></tr>
		<tr><td>Member Since</td><td>{{ created }}</td></tr>
		<tr><td>Biography</td><td>{{ bio }}</td></tr>
		<tr><td>Tests Created</td><td>{{ my_tests.tests|length }}</td></tr>
		<tr><td>Tests Completed</td><td>{{ completed.marks|length }}</td></tr>
		<tr><td>Tests In-Progress</td><td>{{ in_progress.marks|length }}</td></tr>
		<tr><td>Last Updated</td><td>{{ modified }}</td></tr>
	</tbody>
</table>
</section>


<section class="col_7" >
	<header><h3>My Tests</h3></header>
	{% for test in my_tests.tests %}
		<div class="test-preview{%if test.num_marked != test.times_taken %} new-to-be-marked{% endif %}"> 
		{% include "test.html" %}
        <a href="{{ nav_urls.create_test }}/{{ test.id }}" class="button">Edit</a>
        {% if test.open %}
            <a href="{{ nav_urls.tests }}/{{ test.id }}/f" class="button">Close Test</a>
        {% else %}
            <a href="{{ nav_urls.tests }}/{{ test.id }}/t" class="button">Open Test</a>
        {% endif %}
		</div>
    {% empty %}
        <p>You haven't created any tests yet.</p>
	{% endfor %}
    {% if my_tests.next and my_tests.more %}
        <a href="?next_created={{ my_tests.next }}">See more...</a>
    {% endif %}
</section>

<section class="col_7" >
	<header><h3>In-Progress Tests</h3></header>
    {% for mark in in_progress.marks %}
	<div class="test-preview"> 
        {% with mark.test as test %}
		{% include "test.html" %}
        {% endwith %}
	</div>
    {% empty %}
        {% if completed %}
            <p>All your answers have been marked</p>
        {% else %}
            <p>You haven't taken any tests yet.</p>
        {% endif %}
    {% endfor %}
    {% if in_progress.next and in_progress.more %}
        <a href="?next_in_progress={{ in_progress.next }}">See more...</a>
    {% endif %}
</section>

<section class="col_7" >
	<header><h3>Completed Tests</h3></header>
	{% for mark in completed.marks %}
		<section class="test-preview">
		{% with mark.test as test %}
		{% include "test.html" %}
        {% endwith %}
		</section>
    {% empty %}
        {% if in_progress %}
        <p>None of the tests you have taken have been marked yet.</p>
        {% else %}
        <p>You have to submit a response to a test before you can get a mark.</p>
        {% endif %}
	{% endfor %}
    {% if completed.next and completed.more %}
        <a href="?next_completed={{ completed.next }}">See more...</a>
    {% endif %}
</section>

{% endblock content %}